{
    "key": "transition",
    "version": "1.0.0",
    "domain": "core",
    "flow": "sys-schemas",
    "flowVersion": "1.0.0",
    "tags": [
        "Core",
        "Schema",
        "Transition",
        "Workflow"
    ],
    "attributes": {
        "$schema": "https://json-schema.org/draft/2020-12/schema",
        "$id": "https://schemas.amorphie.com/core/transition.json",
        "title": "Transition",
        "description": "İş akışında state'ler arası geçişi tanımlayan şema. Kullanıcı etkileşimi, otomatik tetikleme ve veri validasyonu içerir.",
        "type": "object",
        "properties": {
            "key": {
                "type": "string",
                "description": "Geçişin anahtar değeri. Geçiş talebinde kullanılır ve akış özelinde tekildir.",
                "pattern": "^[a-zA-Z0-9\\-]+$",
                "maxLength": 255
            },
            "target": {
                "type": "string",
                "description": "Geçiş başarılı tamamlandığında erişeceği state key'i",
                "pattern": "^[a-zA-Z0-9\\-]+$",
                "maxLength": 255
            },
            "from": {
                "type": "string",
                "description": "Kaynak state key'i",
                "pattern": "^[a-zA-Z0-9\\-]+$",
                "maxLength": 255
            },
            "versionStrategy": {
                "type": "string",
                "enum": [
                    "Minor",
                    "Major"
                ],
                "description": "Başarılı geçiş sonrasında versiyon artış stratejisi",
                "maxLength": 50
            },
            "triggerType": {
                "type": "integer",
                "enum": [
                    0,
                    1,
                    2,
                    3
                ],
                "description": "Trigger türü. 0=Manual, 1=Automatic, 2=Timeout, 3=Event"
            },
            "availableIn": {
                "type": "array",
                "items": {
                    "type": "string"
                },
                "description": "Bu transition'ın kullanılabileceği state'lerin listesi"
            },
            "schema": {
                "anyOf": [
                    {
                        "$ref": "Reference.1.0.0.json#/attributes"
                    },
                    {
                        "type": "null"
                    }
                ],
                "description": "Geçişi çalıştırmak için gönderilmesi gereken veri şeması referansı"
            },
            "rule": {
                "anyOf": [
                    {
                        "type": "object",
                        "required": [
                            "code",
                            "location"
                        ],
                        "properties": {
                            "code": {
                                "type": "string",
                                "description": "Rule kodu"
                            },
                            "location": {
                                "type": "string",
                                "description": "Kod dosyasının konumu"
                            }
                        },
                        "additionalProperties": false
                    },
                    {
                        "type": "null"
                    }
                ],
                "description": "Kural tabanlı ilerleme olacak ise kuralın tanımlandığı kod"
            },
            "timer": {
                "anyOf": [
                    {
                        "type": "object",
                        "required": [
                            "reset",
                            "duration"
                        ],
                        "properties": {
                            "reset": {
                                "type": "string",
                                "description": "Zamanlayıcı reset stratejisi"
                            },
                            "duration": {
                                "type": "string",
                                "pattern": "^P(?=\\d|T\\d)(\\d+Y)?(\\d+M)?(\\d+D)?(T(\\d+H)?(\\d+M)?(\\d+S)?)?$",
                                "description": "Süre bilgisi (ISO 8601 formatında)",
                                "maxLength": 100
                            }
                        },
                        "additionalProperties": false
                    },
                    {
                        "type": "null"
                    }
                ],
                "description": "Otomatik olarak geçiş çalışacak ise zamanlama bilgisi"
            },
            "labels": {
                "$ref": "Label.1.0.0.json#/attributes",
                "description": "Çok dilli geçiş ismi"
            },
            "view": {
                "anyOf": [
                    {
                        "$ref": "Reference.1.0.0.json#/attributes"
                    },
                    {
                        "type": "null"
                    }
                ],
                "description": "Geçişte kullanılacak view referansı"
            },
            "onExecutionTasks": {
                "type": "array",
                "items": {
                    "type": "object",
                    "required": [
                        "order",
                        "task",
                        "mapping"
                    ],
                    "properties": {
                        "order": {
                            "type": "integer",
                            "minimum": 1,
                            "description": "Görevin çalışma sırası"
                        },
                        "task": {
                            "$ref": "Reference.1.0.0.json#/attributes",
                            "description": "Çalıştırılacak task referansı"
                        },
                        "mapping": {
                            "type": "object",
                            "required": [
                                "code",
                                "location"
                            ],
                            "properties": {
                                "code": {
                                    "type": "string",
                                    "description": "Mapping kodu"
                                },
                                "location": {
                                    "type": "string",
                                    "description": "Kod dosyasının konumu"
                                }
                            },
                            "additionalProperties": false
                        }
                    },
                    "additionalProperties": false
                },
                "description": "Geçiş tetiklendiğinde çalıştırılacak görevler"
            }
        },
        "required": [
            "key",
            "target",
            "versionStrategy",
            "triggerType",
            "labels"
        ],
        "additionalProperties": false
    }
}
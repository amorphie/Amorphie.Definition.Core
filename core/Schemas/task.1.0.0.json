{
  "key": "task",
  "version": "1.0.0",
  "domain": "core",
  "flow": "sys-schemas",
  "flowVersion": "1.0.0",
  "tags": [
    "Core",
    "Schema",
    "Task",
    "Polymorphic"
  ],
  "attributes": {
    "type": "task",
    "schema": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "$id": "https://schemas.amorphie.com/core/task.json",
      "title": "Task Definition",
      "description": "Polimorfik task tanımları. Task tipine göre farklı konfigürasyon şemaları kullanır.",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "description": "Task tipi (TaskType enum değeri string olarak)",
          "enum": [
            "1",
            "2",
            "3",
            "4",
            "5",
            "6",
            "7"
          ]
        }
      },
      "required": [
        "type"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {
                "const": "1"
              }
            }
          },
          "then": {
            "title": "DaprHttpEndpoint Task",
            "properties": {
              "type": {
                "const": "1"
              },
              "endpointName": {
                "type": "string",
                "description": "HTTPEndpoint component adı",
                "minLength": 1
              },
              "path": {
                "type": "string",
                "description": "BaseUrl'e eklenecek path",
                "minLength": 1
              },
              "method": {
                "type": "string",
                "description": "HTTP metodu",
                "default": "GET"
              },
              "headers": {
                "description": "Ek header bilgileri JSON formatında"
              }
            },
            "required": [
              "type",
              "endpointName",
              "path"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "2"
              }
            }
          },
          "then": {
            "title": "DaprBinding Task",
            "properties": {
              "type": {
                "const": "2"
              },
              "bindingName": {
                "type": "string",
                "description": "Binding adı",
                "minLength": 1
              },
              "operation": {
                "type": "string",
                "description": "Binding operasyonu",
                "minLength": 1
              },
              "metadata": {
                "description": "Binding metadata bilgileri"
              },
              "data": {
                "description": "Binding data bilgileri"
              }
            },
            "required": [
              "type",
              "bindingName",
              "operation"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "3"
              }
            }
          },
          "then": {
            "title": "DaprService Task",
            "properties": {
              "type": {
                "const": "3"
              },
              "appId": {
                "type": "string",
                "description": "Dapr App ID",
                "minLength": 1
              },
              "methodName": {
                "type": "string",
                "description": "Çağrılacak method adı",
                "minLength": 1
              },
              "httpVerb": {
                "type": "string",
                "description": "HTTP verb",
                "minLength": 1
              },
              "data": {
                "description": "Gönderilecek data"
              },
              "queryString": {
                "type": [
                  "string",
                  "null"
                ],
                "description": "Query string parametreleri"
              },
              "timeoutSeconds": {
                "type": "integer",
                "description": "Timeout süresi (saniye)",
                "default": 30,
                "minimum": 1
              }
            },
            "required": [
              "type",
              "appId",
              "methodName",
              "httpVerb"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "4"
              }
            }
          },
          "then": {
            "title": "DaprPubSub Task",
            "properties": {
              "type": {
                "const": "4"
              },
              "pubSubName": {
                "type": "string",
                "description": "PubSub component adı",
                "minLength": 1
              },
              "topic": {
                "type": "string",
                "description": "Topic adı",
                "minLength": 1
              },
              "data": {
                "description": "Publish edilecek data"
              },
              "metadata": {
                "description": "PubSub metadata bilgileri"
              }
            },
            "required": [
              "type",
              "pubSubName",
              "topic"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "5"
              }
            }
          },
          "then": {
            "title": "Human Task",
            "properties": {
              "type": {
                "const": "5"
              },
              "title": {
                "type": "string",
                "description": "Task başlığı",
                "minLength": 1
              },
              "instructions": {
                "type": "string",
                "description": "Task talimatları",
                "minLength": 1
              },
              "assignedTo": {
                "type": "string",
                "description": "Atanan kişi/grup",
                "minLength": 1
              },
              "dueDate": {
                "type": [
                  "string",
                  "null"
                ],
                "description": "Bitiş tarihi (ISO 8601 format)",
                "format": "date-time"
              },
              "form": {
                "description": "Form tanımı JSON formatında"
              },
              "reminderIntervalMinutes": {
                "type": "integer",
                "description": "Hatırlatma aralığı (dakika)",
                "minimum": 0
              },
              "escalationTimeoutMinutes": {
                "type": "integer",
                "description": "Escalation timeout (dakika)",
                "minimum": 0
              },
              "escalationAssignee": {
                "type": "string",
                "description": "Escalation atanacak kişi/grup"
              }
            },
            "required": [
              "type",
              "title",
              "instructions",
              "assignedTo"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "6"
              }
            }
          },
          "then": {
            "title": "Http Task",
            "properties": {
              "type": {
                "const": "6"
              },
              "url": {
                "type": "string",
                "description": "HTTP URL",
                "minLength": 1,
                "format": "uri"
              },
              "method": {
                "type": "string",
                "description": "HTTP metodu",
                "default": "GET"
              },
              "headers": {
                "description": "HTTP header bilgileri JSON formatında"
              },
              "body": {
                "description": "HTTP body JSON formatında"
              },
              "timeoutSeconds": {
                "type": "integer",
                "description": "Timeout süresi (saniye)",
                "default": 30,
                "minimum": 1
              },
              "validateSsl": {
                "type": "boolean",
                "description": "SSL doğrulaması yapılsın mı",
                "default": true
              }
            },
            "required": [
              "type",
              "url"
            ],
            "additionalProperties": false
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "7"
              }
            }
          },
          "then": {
            "title": "Script Task",
            "properties": {
              "type": {
                "const": "7"
              }
            },
            "required": [
              "type"
            ],
            "additionalProperties": false
          }
        }
      ],
      "additionalProperties": false
    }
  }
}
